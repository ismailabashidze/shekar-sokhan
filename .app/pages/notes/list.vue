<script setup lang="ts">
definePageMeta({
  title: 'یادداشت‌ها',
  layout: 'sidebar',
})
useHead({ htmlAttrs: { dir: 'rtl' } })

// Mock data for notes
const pending = ref(false)
const error = ref(null)

const data = ref([
  {
    id: '1',
    title: 'جلسه هفتگی با تیم محصول',
    content: 'در جلسه امروز، موارد زیر مورد بررسی قرار گرفت:\n\n1. بررسی وضعیت اسپرینت فعلی:\n   - تیم فرانت‌اند: ۸۵٪ از تسک‌ها تکمیل شده‌اند\n   - تیم بک‌اند: تمام API‌های مورد نیاز آماده شده‌اند\n   - تیم طراحی: طراحی‌های جدید صفحه پروفایل در انتظار بازبینی نهایی هستند\n\n2. برنامه‌ریزی برای ریلیز بعدی (نسخه v1.2.0):\n   - زمان انتشار: ۲۰ خرداد ۱۴۰۴\n   - ویژگی‌های اصلی: بهبود داشبورد کاربران، سیستم یادداشت‌ها، بهینه‌سازی عملکرد\n   - مسئول آماده‌سازی مستندات: علی\n\n3. اولویت‌بندی باگ‌های گزارش شده توسط کاربران:\n   - اولویت بالا: مشکل لاگین با حساب‌های گوگل، کندی بارگذاری در صفحه داشبورد\n   - اولویت متوسط: مشکلات رابط کاربری در نسخه موبایل، خطاهای گاه‌به‌گاه در آپلود فایل\n   - اولویت پایین: بهبود پیام‌های خطا، اصلاح نوشته‌های راهنما\n\nشرکت‌کنندگان: محمد، سارا، علی، نیما، پریسا\nمحل جلسه: اتاق کنفرانس اصلی\nزمان جلسه بعدی: چهارشنبه آینده، ساعت ۱۰ صبح',
    createdAt: '2025-04-30T10:30:00',
    updatedAt: '2025-05-01T14:15:00',
    tags: ['جلسه', 'اسپرینت', 'برنامه‌ریزی'],
    category: 'جلسات داخلی',
  },
  {
    id: '2',
    title: 'ایده‌های جدید برای محصول',
    content: 'در جلسه طوفان فکری امروز، ایده‌های زیر برای بهبود محصول مطرح شدند:\n\n1. اضافه کردن قابلیت یادداشت‌برداری:\n   - امکان ثبت یادداشت‌های خصوصی برای هر کاربر\n   - قابلیت دسته‌بندی یادداشت‌ها\n   - جستجو در متن یادداشت‌ها\n   - امکان اشتراک‌گذاری با سایر کاربران\n   - پشتیبانی از مارک‌داون در نوشتن یادداشت‌ها\n\n2. بهبود رابط کاربری داشبورد:\n   - طراحی مجدد ویجت‌ها برای نمایش بهتر اطلاعات\n   - اضافه کردن نمودارهای تعاملی برای تحلیل داده‌ها\n   - امکان شخصی‌سازی چیدمان داشبورد توسط کاربر\n   - اضافه کردن حالت تاریک (Dark Mode)\n\n3. پیاده‌سازی سیستم اعلان‌ها برای کاربران:\n   - اعلان‌های درون برنامه‌ای (Inbox)\n   - اعلان‌های مرورگر (Web Push Notifications)\n   - اعلان‌های ایمیلی با قابلیت تنظیم\n   - اعلان موارد مهم از طریق پیامک\n\n4. بهبود سیستم جستجو:\n   - جستجوی هوشمند با پیشنهاد خودکار\n   - فیلترهای پیشرفته\n   - جستجو در فایل‌ها و محتوای آن‌ها\n\nدر مرحله بعد باید این ایده‌ها اولویت‌بندی شوند و طرح اولیه برای موارد با اولویت بالا تهیه شود.\nمسئول پیگیری: نیما',
    createdAt: '2025-05-03T09:45:00',
    updatedAt: '2025-05-03T09:45:00',
    tags: ['ایده‌پردازی', 'توسعه محصول', 'رابط کاربری'],
    category: 'توسعه محصول',
  },
  {
    id: '3',
    title: 'راهنمای استفاده از API جدید',
    content: 'مستندات مربوط به API جدید مدیریت کاربران (نسخه v2):\n\n## نقاط پایانی (Endpoints):\n```\nGET /api/v2/users               # دریافت لیست کاربران\nPOST /api/v2/users              # ایجاد کاربر جدید\nGET /api/v2/users/:id           # دریافت اطلاعات یک کاربر\nPUT /api/v2/users/:id           # بروزرسانی اطلاعات کاربر\nDELETE /api/v2/users/:id        # حذف کاربر\nGET /api/v2/users/:id/activities # دریافت فعالیت‌های کاربر\nGET /api/v2/users/:id/notes     # دریافت یادداشت‌های کاربر\nPOST /api/v2/users/:id/notes    # افزودن یادداشت جدید برای کاربر\n```\n\n## احراز هویت:\nتمام درخواست‌ها نیاز به هدر احراز هویت دارند:\n```\nAuthorization: Bearer YOUR_API_TOKEN\n```\n\n## پارامترهای فیلتر:\nبرای endpoint دریافت لیست کاربران، می‌توانید از پارامترهای زیر استفاده کنید:\n\n- `page`: شماره صفحه (پیش‌فرض: 1)\n- `limit`: تعداد آیتم در هر صفحه (پیش‌فرض: 20، حداکثر: 100)\n- `sort`: فیلد مرتب‌سازی (گزینه‌ها: name, email, created_at, updated_at)\n- `order`: ترتیب مرتب‌سازی (گزینه‌ها: asc, desc)\n- `search`: جستجو در نام و ایمیل کاربران\n\n## مثال درخواست‌ها:\n\n### دریافت لیست کاربران:\n```javascript\nfetch("/api/v2/users?page=1&limit=20&sort=created_at&order=desc", {\n  headers: {\n    "Authorization": "Bearer YOUR_API_TOKEN"\n  }\n})\n.then(response => response.json())\n.then(data => console.log(data));\n```\n\n### ایجاد کاربر جدید:\n```javascript\nfetch("/api/v2/users", {\n  method: "POST",\n  headers: {\n    "Authorization": "Bearer YOUR_API_TOKEN",\n    "Content-Type": "application/json"\n  },\n  body: JSON.stringify({\n    name: "کاربر جدید",\n    email: "user@example.com",\n    role: "user"\n  })\n})\n.then(response => response.json())\n.then(data => console.log(data));\n```\n\nبرای اطلاعات بیشتر به مستندات کامل API در بخش داکیومنتیشن مراجعه کنید.',
    createdAt: '2025-05-05T16:20:00',
    updatedAt: '2025-05-05T16:20:00',
    tags: ['API', 'مستندات', 'توسعه'],
    category: 'مستندات فنی',
  },
  {
    id: '4',
    title: 'برنامه زمانی جلسات آینده',
    content: '## برنامه جلسات هفته آینده (۱۲ تا ۱۸ خرداد ۱۴۰۴):\n\n### دوشنبه - ۱۲ خرداد:\n- **جلسه بررسی محصول** (ساعت ۱۰ صبح)\n  - محل: اتاق کنفرانس اصلی\n  - اعضا: تیم مدیریت محصول، نمایندگان توسعه و طراحی\n  - دستور جلسه: ارزیابی ویژگی‌های نسخه بتا، گزارش بازخورد کاربران، تصمیم‌گیری درباره ویژگی‌های کلیدی نسخه بعدی\n  - مسئول هماهنگی: سارا\n\n### سه‌شنبه - ۱۳ خرداد:\n- **جلسه با تیم بازاریابی** (ساعت ۲ بعد از ظهر)\n  - محل: اتاق جلسات طبقه دوم\n  - اعضا: تیم بازاریابی، مدیر محصول، مدیر فروش\n  - دستور جلسه: استراتژی بازاریابی برای ریلیز جدید، هماهنگی کمپین تبلیغاتی، تعیین شاخص‌های موفقیت\n  - مسئول هماهنگی: علی\n  - نیازمندی‌ها: لپ‌تاپ، پروژکتور، آمار فروش ماه گذشته\n\n### چهارشنبه - ۱۴ خرداد:\n- **جلسه برنامه‌ریزی اسپرینت** (ساعت ۹ صبح)\n  - محل: اتاق اسکرام\n  - اعضا: تیم توسعه، اسکرام مستر، مالک محصول\n  - دستور جلسه: بررسی بک‌لاگ، تخمین زمان تسک‌ها، تعیین هدف اسپرینت\n  - مسئول هماهنگی: نیما\n\n### پنجشنبه - ۱۵ خرداد:\n- **جلسه اسپرینت ریویو** (ساعت ۱۱ صبح)\n  - محل: سالن اصلی با امکان حضور آنلاین\n  - اعضا: تمام تیم‌های پروژه، مدیران ارشد، نمایندگان مشتریان کلیدی\n  - دستور جلسه: نمایش ویژگی‌های تکمیل شده، گزارش پیشرفت، دریافت بازخورد\n  - مسئول هماهنگی: پریسا\n  - نیازمندی‌ها: دمو کامل محصول، آمادگی تیم برای پاسخگویی به سوالات فنی\n\n### جمعه - ۱۶ خرداد:\n- **جلسه رترو** (ساعت ۱۰ صبح)\n  - محل: اتاق اسکرام\n  - اعضا: تیم توسعه، اسکرام مستر\n  - دستور جلسه: بررسی نقاط قوت و ضعف اسپرینت، شناسایی فرصت‌های بهبود، تعیین اقدامات اصلاحی\n  - مسئول هماهنگی: محمد\n\n*نکته: لطفاً در صورت عدم امکان حضور، حداقل ۲۴ ساعت قبل اطلاع دهید.*',
    createdAt: '2025-05-06T11:10:00',
    updatedAt: '2025-05-06T11:10:00',
    tags: ['جلسات', 'برنامه‌ریزی', 'اسپرینت'],
    category: 'برنامه‌ریزی',
  },
  {
    id: '5',
    title: 'لیست وظایف پروژه زهنا',
    content: '# وظایف باقیمانده پروژه زهنا\n\n## بخش‌های اصلی:\n\n### ۱. تکمیل قابلیت یادداشت‌برداری:\n- [x] طراحی رابط کاربری صفحات یادداشت\n- [x] ایجاد کامپوننت‌های لازم برای نمایش و ویرایش یادداشت‌ها\n- [ ] پیاده‌سازی API های مورد نیاز در سمت سرور\n- [ ] پیاده‌سازی قابلیت جستجو در یادداشت‌ها\n- [ ] امکان دسته‌بندی یادداشت‌ها\n- [ ] پیاده‌سازی قابلیت پشتیبانی از مارک‌داون\n- [ ] تست‌های واحد و انسجام\n\n### ۲. رفع باگ‌های گزارش شده در پنل ادمین:\n- [ ] مشکل نمایش اطلاعات کاربران در حالت موبایل (شماره تیکت: #4532)\n- [ ] خطا در فیلتر کردن داده‌ها بر اساس تاریخ (شماره تیکت: #4561)\n- [ ] مشکل احراز هویت دوعاملی برای کاربران ادمین (شماره تیکت: #4590)\n- [ ] عدم بارگذاری صحیح نمودارها در داشبورد ادمین (شماره تیکت: #4612)\n- [ ] رفع مشکل پاگینیشن در لیست تراکنش‌ها (شماره تیکت: #4623)\n\n### ۳. بهینه‌سازی سرعت بارگذاری صفحات:\n- [ ] بهینه‌سازی تصاویر و استفاده از فرمت‌های مدرن (WebP)\n- [ ] پیاده‌سازی Lazy Loading برای کامپوننت‌های سنگین\n- [ ] بهبود کش کردن داده‌ها\n- [ ] کاهش حجم بسته‌های JavaScript با استفاده از Code Splitting\n- [ ] بهینه‌سازی فونت‌ها و آیکون‌ها\n- [ ] بهبود Lighthouse Score همه صفحات (هدف: بالای 90)\n\n### ۴. بروزرسانی کتابخانه‌های مورد استفاده:\n- [ ] به‌روزرسانی Nuxt.js به آخرین نسخه پایدار\n- [ ] به‌روزرسانی TailwindCSS و پلاگین‌های مرتبط\n- [ ] بررسی وابستگی‌های امنیتی با استفاده از npm audit\n- [ ] جایگزینی کتابخانه‌های قدیمی با گزینه‌های جدید و بهینه‌تر\n- [ ] بازنویسی کدهای ناسازگار با نسخه‌های جدید\n\n## مهلت اتمام کار: ۲۵ خرداد ۱۴۰۴\n\n## مسئولین بخش‌های مختلف:\n- بخش یادداشت‌برداری: علی\n- رفع باگ‌های پنل ادمین: سارا\n- بهینه‌سازی سرعت: نیما\n- به‌روزرسانی کتابخانه‌ها: محمد\n\n## یادآوری مهم:\n- جلسه بررسی پیشرفت: چهارشنبه، ۱۴ خرداد، ساعت ۱۳:۳۰\n- ارسال گزارش روزانه در کانال اسلک #zehna-project\n- مستندسازی تمام تغییرات در Wiki پروژه',
    createdAt: '2025-05-07T08:30:00',
    updatedAt: '2025-05-07T08:30:00',
    tags: ['پروژه', 'وظایف', 'برنامه‌ریزی'],
    category: 'مدیریت پروژه',
  },
])
</script>

<template>
  <div class="container mx-auto px-4 py-8">
    <div class="mb-6 flex items-center justify-between">
      <h1 class="text-2xl font-bold">
        یادداشت‌ها
      </h1>
      <NuxtLink to="/notes/create" class="bg-primary hover:bg-primary-dark rounded-md px-4 py-2 text-white">
        یادداشت جدید
      </NuxtLink>
    </div>

    <div v-if="pending" class="flex justify-center py-10">
      <div class="loader" />
    </div>

    <div v-else-if="error" class="rounded border border-red-400 bg-red-100 px-4 py-3 text-red-700">
      خطا در بارگذاری یادداشت‌ها
    </div>

    <div v-else-if="!data || data.length === 0" class="py-10 text-center text-gray-500">
      یادداشتی یافت نشد
    </div>

    <div v-else class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
      <div
        v-for="note in data"
        :key="note.id"
        class="overflow-hidden rounded-lg bg-white shadow-md transition-shadow duration-300 hover:shadow-lg"
      >
        <NuxtLink :to="`/notes/${note.id}`">
          <div class="p-6">
            <!-- دسته‌بندی یادداشت -->
            <div class="mb-2 flex items-center justify-between">
              <span v-if="note.category" class="bg-primary/10 text-primary rounded-full px-2 py-1 text-xs">
                {{ note.category }}
              </span>
              <span v-if="note.updatedAt && note.updatedAt !== note.createdAt" class="text-xs text-gray-400">
                ویرایش شده
              </span>
            </div>

            <h2 class="mb-2 truncate text-xl font-semibold">
              {{ note.title }}
            </h2>
            <p class="line-clamp-3 text-gray-600">
              {{ note.content }}
            </p>

            <!-- برچسب‌ها و تاریخ -->
            <div class="mt-4 flex flex-wrap items-center justify-between">
              <div class="mb-1 flex flex-wrap gap-1">
                <span
                  v-for="tag in note.tags"
                  :key="tag"
                  class="rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-600"
                >
                  {{ tag }}
                </span>
              </div>
              <div class="text-xs text-gray-500">
                {{ new Date(note.createdAt).toLocaleDateString('fa-IR') }}
              </div>
            </div>
          </div>
        </NuxtLink>
      </div>
    </div>
  </div>
</template>

<style scoped>
.loader {
  border: 4px solid rgba(0, 0, 0, 0.1);
  border-left: 4px solid #3498db;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>
